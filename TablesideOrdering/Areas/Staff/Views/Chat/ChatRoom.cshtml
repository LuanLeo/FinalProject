@using System.Security.Claims;
@using TablesideOrdering.Areas.Staff.ViewModels;
@model ChatViewModel;
@{
    ViewData["Title"] = "Staff Area";
    Layout = "~/Areas/Staff/Views/Shared/_LayoutMiddleChat.cshtml";
}

<script src="https://cdn.jsdelivr.net/npm/jquery@3.6.4/dist/jquery.slim.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/popper.js@1.16.1/dist/umd/popper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js"></script>

<link rel="stylesheet" href="~/css/toaststyle.css" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">

<div class="modal-dialog-scrollable">
    <div class="modal-content">
        <div class="msg-head">
            <div class="row">
                <div class="col-8">
                    <div class="d-flex align-items-center">
                        <div class="flex-shrink-0">
                            <img class="img-fluid" src="~/Logo/Avatar/defaultavatar.png" alt="user img" height="45px" width="45px">
                        </div>
                        <div class="flex-grow-1 ms-3">
                            <h3>Table - @Model.ChatRoom.ChatRoomID</h3>
                            <p>Customer</p>
                        </div>
                    </div>
                </div>
                <div class="col-4">
                    <ul class="moreoption">
                        <li class="navbar nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false"><i class="fa fa-ellipsis-v" aria-hidden="true"></i></a>
                            <ul class="dropdown-menu">
                                <li><a class="dropdown-item" href="#">Action</a></li>
                                <li><a class="dropdown-item" href="#">Another action</a></li>
                                <li>
                                    <hr class="dropdown-divider">
                                </li>
                                <li><a class="dropdown-item" href="#">Something else here</a></li>
                            </ul>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="modal-body" id='messageBody'>
            <div class="msg-body">
                <ul>
                    @foreach (var i in Model.ChatHistory)
                    {
                        if (i.Sender != Model.ChatRoom.ChatRoomID)
                        {
                            <li class="sender">
                                <p>@i.Message</p>
                                <span class="time">@i.MessageDate</span>
                            </li>
                        }
                        else
                        {
                            <li class="repaly">
                                <p>@i.Message</p>
                                <span class="time">@i.MessageDate</span>
                            </li>
                        }
                    }
                </ul>
            </div>
            <div class="msg-body" id="chatbox">
               
            </div>
        </div>


        <div class="send-box">
            <div class="send-box">
                <form>
                    <input type="text" class="form-control" aria-label="message…" placeholder="Write message…" id="messageInput">
                    <input type="hidden" id="userInput" value="@Model.StaffRole" />
                    <input type="hidden" id="receiverInput" value="@Model.ChatRoom.ChatRoomID" />
                    <button type="submit" id="sendButton"> <i class="fa fa-paper-plane" aria-hidden="true"></i> Send</button>
                </form>
            </div>       
        </div>
    </div>
</div>
<script src="~/lib/microsoft/signalr/dist/browser/signalr.js"></script>
<script src="~/js/chatstaff.js"></script>
